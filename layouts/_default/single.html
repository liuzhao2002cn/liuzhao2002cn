{{ define "main" }}
<article class="post-single post-container">
    <header class="post-header">
        {{ with .Params.image }}
        <div class="post-cover">
            {{ with $.Resources.GetMatch . }}
                {{ $image := .Resize "1200x webp q75" }}
                {{ $fallback := .Resize "1200x q75" }}
                <picture>
                    <source srcset="{{ $image.RelPermalink }}" type="image/webp">
                    <img src="{{ $fallback.RelPermalink }}" width="{{ $fallback.Width }}" height="{{ $fallback.Height }}" alt="{{ $.Title }}" loading="lazy">
                </picture>
            {{ end }}
        </div>
        {{ end }}
        <h1 class="post-title">{{ .Title }}</h1>
        <div class="post-meta">
            <span class="meta-item"><time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "2006年1月2日" }}</time></span>
            {{ with .Params.categories }}<span class="meta-divider">·</span><span class="meta-item">{{ range . }}<a href="{{ "/categories/" | relURL }}{{ . | urlize }}/">{{ . }}</a>{{ end }}</span>{{ end }}
            <span class="meta-divider">·</span><span class="meta-item">{{ .ReadingTime }} 分钟阅读</span>
        </div>
    </header>
    {{ if .TableOfContents }}
    <details class="toc-container" id="toc" open>
        <summary class="toc-title"><span>目录</span></summary>
        <div class="toc-content">{{ .TableOfContents }}</div>
    </details>
    {{ end }}
    <div class="post-content">{{ .Content }}</div>
    <footer class="post-footer">
        {{ with .Params.tags }}<div class="post-tags">{{ range . }}<a href="{{ "/tags/" | relURL }}{{ . | urlize }}/" class="tag-link">#{{ . }}</a>{{ end }}</div>{{ end }}
        {{ partial "share.html" . }}
    </footer>
    {{ partial "related.html" . }}
    {{ partial "comments.html" . }}
</article>
{{ end }}
