{{ define "main" }}
<article class="post-single" data-pagefind-body>
    <div class="container">
        <div class="content-wrapper">
            <!-- 文章头部 -->
            <header class="post-header">
                <h1 class="post-title" data-pagefind-meta="title">{{ .Title }}</h1>
                
                <div class="post-meta">
                    <span class="meta-item">
                        <span class="meta-icon">📅</span>
                        <time datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
                            {{ .Date.Format "2006年1月2日" }}
                        </time>
                    </span>
                    
                    {{ with .Params.categories }}
                    <span class="meta-divider">·</span>
                    <span class="meta-item">
                        <span class="meta-icon">📁</span>
                        {{ range . }}
                        <a href="{{ "/categories/" | relURL }}{{ . | urlize }}/" class="meta-link">{{ . }}</a>
                        {{ end }}
                    </span>
                    {{ end }}
                    
                    <span class="meta-divider">·</span>
                    <span class="meta-item">
                        <span class="meta-icon">⏱️</span>
                        {{ .ReadingTime }} 分钟
                    </span>
                    
                    {{ if .WordCount }}
                    <span class="meta-divider">·</span>
                    <span class="meta-item">
                        <span class="meta-icon">📝</span>
                        {{ .WordCount }} 字
                    </span>
                    {{ end }}
                </div>
            </header>

            <!-- 目录（折叠式） -->
            {{ if .TableOfContents }}
            <details class="toc-container" id="toc" open>
                <summary class="toc-title">
                    <span class="toc-icon">📑</span>
                    <span class="toc-text">目录</span>
                    <span class="toc-toggle">▼</span>
                </summary>
                <div class="toc-content">
                    {{ .TableOfContents }}
                </div>
            </details>
            {{ end }}

            <!-- 文章正文 -->
            <div class="post-content">
                {{ .Content }}
            </div>

            <!-- 文章底部 -->
            <footer class="post-footer">
                <!-- 标签 -->
                {{ with .Params.tags }}
                <div class="post-tags">
                    <span class="tags-label">标签：</span>
                    {{ range . }}
                    <a href="{{ "/tags/" | relURL }}{{ . | urlize }}/" class="tag-link">#{{ . }}</a>
                    {{ end }}
                </div>
                {{ end }}

                <!-- 分享按钮 -->
                {{ partial "share.html" . }}

                <!-- 上一篇/下一篇 -->
                <nav class="post-navigation">
                    {{ with .PrevInSection }}
                    <a href="{{ .Permalink }}" class="nav-link nav-prev" title="{{ .Title }}">
                        <span class="nav-arrow">←</span>
                        <span class="nav-text">
                            <span class="nav-label">上一篇</span>
                            <span class="nav-title">{{ .Title }}</span>
                        </span>
                    </a>
                    {{ end }}
                    
                    {{ with .NextInSection }}
                    <a href="{{ .Permalink }}" class="nav-link nav-next" title="{{ .Title }}">
                        <span class="nav-text">
                            <span class="nav-label">下一篇</span>
                            <span class="nav-title">{{ .Title }}</span>
                        </span>
                        <span class="nav-arrow">→</span>
                    </a>
                    {{ end }}
                </nav>
            </footer>
        </div>
    </div>

    <!-- 相关文章 -->
    {{ partial "related.html" . }}

    <!-- 评论 -->
    {{ partial "comments.html" . }}
</article>

<!-- 固定目录 -->
{{ partial "fixed-toc.html" . }}

<!-- 阅读进度指示器 -->
{{ partial "reading-progress.html" . }}

<!-- 字体大小调节器 -->
{{ partial "font-size-controller.html" . }}
{{ end }}
